<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
  <link rel="stylesheet" href="style.css">
</head>

<body>



  <h1>The XMLHttpRequest Object</h1>

  <button type="button" onclick="loadDoc()">Get my catalog</button>
  <br><br>
  <div id="demo">
    <!-- <div class="product__item product__item--sale">
      <a class="product__item-image" href="#">
        <picture>
          <source type="image/webp" srcset="images/product-img-12.webp">
          <img class="product__img" src="images/product-img-12.webp" alt="">
        </picture>
      </a>
      <div class="product__item-descr">
        <a class="product__item-category" href="#">
          мобильные телефоны
        </a>
        <a class="product__item-title" href="#">
          Мобильный телефон Xiaomi Mi 10 Pro
        </a>
        <div class="product__item-rating">
          <div class="product__rating" data-rateyo-rating="4.3">4.3</div>
          <div class="product__item-reviews"><span class="product__reviews-number">17</span> отзывов</div>
        </div>
        <div class="product__item-footer">
          <div class="product__item-price">
            <div class="product__price-old">35 000 &#8372;</div>
            <div class="product__price-new">27 999 &#8372;</div>
          </div>
          <a href="#" class="product__item-purchase">Купить</a>
        </div>
      </div>
    </div>
    <div class="product__item">
      <a class="product__item-image" href="#">
        <picture>
          <source type="image/webp" srcset="images/product-img-13.webp">
          <img class="product__img" src="images/product-img-13.webp" alt="">
        </picture>
      </a>
      <div class="product__item-descr">
        <a class="product__item-category" href="#">
          мобильные телефоны
        </a>
        <a class="product__item-title" href="#">
          Мобильный телефон Xiaomi Mi 10 Pro
        </a>
        <div class="product__item-rating">
          <div class="product__rating" data-rateyo-rating="4.3">4.3</div>
          <div class="product__item-reviews"><span class="product__reviews-number">17</span> отзывов</div>
        </div>
        <div class="product__item-footer">
          <div class="product__item-price">
            <div class="product__price-old">35 000 &#8372;</div>
            <div class="product__price-new">27 999 &#8372;</div>
          </div>
          <a href="#" class="product__item-purchase">Купить</a>
        </div>
      </div>
    </div>
    <div class="product__item product__item--new">
      <a class="product__item-image" href="#">
        <picture>
          <source type="image/webp" srcset="images/product-img-8.webp">
          <img class="product__img" src="images/product-img-8.webp" alt="">
        </picture>
      </a>
      <div class="product__item-descr">
        <a class="product__item-category" href="#">
          мобильные телефоны
        </a>
        <a class="product__item-title" href="#">
          Мобильный телефон Xiaomi Mi 10 Pro
        </a>
        <div class="product__item-rating">
          <div class="product__rating" data-rateyo-rating="4.3">4.3</div>
          <div class="product__item-reviews"><span class="product__reviews-number">17</span> отзывов</div>
        </div>
        <div class="product__item-footer">
          <div class="product__item-price">
            <div class="product__price-old">35 000 &#8372;</div>
            <div class="product__price-new">27 999 &#8372;</div>
          </div>
          <a href="#" class="product__item-purchase">Купить</a>
        </div>
      </div>
    </div> -->
  </div>

  <script>
    function loadDoc() {
      var xhttp = new XMLHttpRequest();
      xhttp.onreadystatechange = function () {
        if (this.readyState == 4 && this.status == 200) {
          myFunction(this);
        }
      };
      xhttp.open("GET", 'cd_catalog.xml?r=' + Math.random(), true);
      xhttp.send();
    }
    function myFunction(xml) {
      let xmlDOM = xml.responseXML
      let elements = xmlDOM.getElementsByTagName('PRODUCT')
      // console.log(xmlDOM);
      for (let i = 0; i < elements.length; i++) {
        let category = elements[i].getElementsByTagName('CATEGORY')[0].childNodes[0].nodeValue
        let title = elements[i].getElementsByTagName('NAME')[0].childNodes[0].nodeValue
        let rating = elements[i].getElementsByTagName('RATING')[0].childNodes[0].nodeValue
        let price = elements[i].getElementsByTagName('PRICE')[0].childNodes[0].nodeValue
        let imgsrc = elements[i].getElementsByTagName('IMGSRC')[0].childNodes[0].nodeValue
        document.getElementById('demo').innerHTML +=
          `<div class="product__item">
            <a class="product__item-image" href="#">
            <picture>
              <source type="image/webp" srcset="${imgsrc}">
              <img class="product__img" src="${imgsrc}" alt="Product image">
            </picture>
            </a>
            <div class="product__item-descr">
              <a class="product__item-category" href="#">
                ${category}
              </a>
              <a class="product__item-title" href="#">
                ${title}
              </a>
              <div class="product__item-rating">
                <div class="product__rating" data-rateyo-rating="4.3">${rating}</div>
                <div class="product__item-reviews"><span class="product__reviews-number">17</span> отзывов</div>
              </div>
              <div class="product__item-footer">
                <div class="product__item-price">
                  <div class="product__price-old">35 000 &#8372;</div>
                  <div class="product__price-new">${price} &#8372;</div>
                </div>
                <a href="#" class="product__item-purchase">Купить</a>
              </div>
            </div>
          </div>`
      }
    }
  </script>

</body>

</html>